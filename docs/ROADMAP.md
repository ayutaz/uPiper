# uPiper Implementation Roadmap

## 概要

このドキュメントは、uPiper（Unity Piper TTS Plugin）の実装ロードマップです。
Phase 1の実装進捗と今後の計画を管理します。

## Phase 1: Windows/Linux/macOS 基盤実装（計22人日）

### 現在の進捗
- **完了**: 19/22人日（86.4%）
- **残り**: 3人日

### 完了タスク
- ✅ 1.1 Core API - インターフェース設計（1人日）
- ✅ 1.3.1 Core API ユニットテスト（1人日）
- ✅ 1.4 音素化システム - インターフェース（1.5人日）
- ✅ 1.5 音素化システム - キャッシュ実装（2人日）
- ✅ 1.6 音素化システム - テスト（1.5人日）
- ✅ 1.7 OpenJTalk ネイティブライブラリ（4人日）
- ✅ 1.8 P/Invoke バインディング（2人日）
- ✅ 1.9 Unity.InferenceEngine 音声合成（3人日）
- ✅ 1.10 OpenJTalk統合による日本語発音改善（2人日）
- ✅ 1.11 Unity基本統合（1人日）- 2025年1月完了

### 残りタスク
- 🚧 1.2 Core API - 実装（3人日）
  - 1.2.1 PiperConfig バリデーション実装（0.5人日）
  - 1.2.2 PiperTTS 基本構造実装（1人日）
  - 1.2.3 PiperTTS 非同期初期化実装（1人日）
  - 1.2.4 PiperTTS 音声生成スタブ実装（0.5人日）
- 🚧 1.3.2 PiperTTS 初期化テスト（0.5人日）
- 🚧 1.3.3 PiperTTS 音声生成テスト（0.5人日）

### 次の実装予定: Phase 1.12 IL2CPPサポート（2人日）

#### 1.12.1 IL2CPP互換性検証（0.5人日）
- **作業内容**:
  - P/Invoke宣言の確認
  - マーシャリング属性の検証
  - AOT制約の確認
- **成果物**: IL2CPP互換性レポート
- **完了条件**: 非互換箇所の特定

#### 1.12.2 IL2CPPビルド設定（0.5人日）
- **作業内容**:
  - Player Settings設定
  - ストリッピングレベル調整
  - link.xml作成
- **成果物**: link.xml、ビルド設定ドキュメント
- **完了条件**: IL2CPPビルド成功

#### 1.12.3 IL2CPP固有の対応（0.5人日）
- **作業内容**:
  - AOT属性追加
  - 型保持設定
  - ジェネリック型の具体化
- **成果物**: 修正されたソースコード
- **完了条件**: ランタイムエラーなし

#### 1.12.4 IL2CPPパフォーマンステスト（0.5人日）
- **作業内容**:
  - Mono vs IL2CPP比較
  - メモリ使用量測定
  - 起動時間測定
- **成果物**: パフォーマンス比較レポート
- **完了条件**: パフォーマンス基準達成

## Phase 2: Android実装（15人日）

### 現在の進捗
- **完了**: 15/15人日（100%） ✅
- **完了日**: 2025年1月23日

### 完了タスク
- ✅ 2.1 技術検証とビルド環境構築（3人日）
  - Docker環境によるAndroid NDKビルド
  - 全Android ABI対応（arm64-v8a, armeabi-v7a, x86, x86_64）
  
- ✅ 2.2 OpenJTalkネイティブライブラリのAndroidビルド（4人日）
  - CMakeツールチェーン設定
  - 全ABIでのビルド成功
  - CI/CD統合（GitHub Actions）

- ✅ 2.3 Unity Android統合（4人日）
  - P/Invoke経由でのネイティブライブラリ呼び出し
  - StreamingAssetsからPersistentDataPathへの辞書展開
  - Android固有のパス処理実装
  - 実機での音声合成動作確認

- ✅ 2.4 モバイル最適化（2人日）- 部分的に実装
  - 基本的な最適化実装
  - 更なる最適化は今後の課題として残存

- ✅ 2.5 テストとCI/CD統合（2人日）
  - Android自動テスト機能実装
  - GitHub ActionsでのAndroidビルド統合
  - 実機での動作確認完了

### 実装時の主な成果
- libopenjtalk_wrapper.so（全ABI合計約20MB）
- 日本語TTS実機動作確認
- 文字エンコーディング問題の解決（UTF-8対応）
- CI/CDパイプライン統合完了

## 今後のフェーズ

### Phase 3: eSpeak-NG統合（10人日）
- eSpeak-NGのクロスプラットフォームビルド
- 英語音素化の品質向上
- 多言語音素化基盤の構築

### Phase 4: 多言語サポート（15人日）
- 中国語（Mandarin）対応
- 韓国語対応
- 言語自動検出システム
- 混合言語テキスト対応

### Phase 5: WebGL実装（10人日）
- Emscriptenビルド
- WebAssembly最適化
- ブラウザ互換性対応

### Phase 6: iOS実装（10人日）
- Xcodeプロジェクト設定
- Objective-C++ブリッジ
- App Store要件対応

### Phase 7: エディタツール（10人日）
- カスタムインスペクター
- 音声プレビュー機能
- デバッグツール
- VoiceBankマネージャー

### Phase 8: 最適化と品質保証（10人日）
- パフォーマンス最適化
  - Androidメモリ使用量削減
  - 初期化時間短縮
  - ARM NEON最適化
- 自動テスト拡充
- ドキュメント完成

## 現在のステータス

- **Phase 1**: 86.4%完了（基本機能実装済み）
- **Phase 2**: 100%完了（Android対応完了）✅
- **次の優先事項**: Androidパフォーマンス最適化、その後Phase 3（eSpeak-NG統合）