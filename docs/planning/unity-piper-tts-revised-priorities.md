# Unity Piper TTS - Sentis統合による優先順位の再検討

## 背景

Unity Sentis 2.1.2の採用により、音声合成部分がUnity内で完結するようになりました。これにより、特にWebGLプラットフォームの実装難易度が大幅に低下し、優先順位の見直しが必要です。

## 優先順位の再評価

### 現在の優先順位
1. Windows/Linux（★★★★★）
2. Android（★★★★☆）
3. macOS（★★★☆☆）
4. iOS（★★☆☆☆）
5. WebGL（★☆☆☆☆）

### 提案する新しい優先順位

#### オプション1: WebGLを早期に対応
1. **Windows/Linux**（★★★★★）- 変更なし
2. **Android**（★★★★☆）- 変更なし
3. **WebGL**（★★★☆☆）- 優先度上昇 ⬆️
4. **macOS**（★★☆☆☆）- 優先度低下 ⬇️
5. **iOS**（★☆☆☆☆）- 優先度低下 ⬇️

#### オプション2: 現状維持
- 既存の優先順位を維持
- WebGLは最後に実装

## 各オプションの評価

### オプション1の利点（WebGL早期対応）

#### 技術的利点
- Sentisにより、ONNX Runtimeの移植が不要
- 音素化ライブラリのみWebAssembly化すればよい
- Unity 6のWebGPU対応により高速実行可能

#### ビジネス的利点
- ブラウザベースのデモが早期に可能
- インストール不要で試用できる
- マーケティング効果が高い

#### 開発効率
- Sentisが既にWebGL対応済み
- 音素化部分は既存のEmscriptenビルドスクリプトを活用可能

### オプション2の利点（現状維持）

#### 技術的利点
- ネイティブプラットフォームに集中できる
- パフォーマンスが保証されたプラットフォームから順に対応

#### リスク管理
- WebGLの制限事項（メモリ、パフォーマンス）を後回しにできる
- 確実に動作するプラットフォームから提供

## 推奨案

### 推奨: オプション1（WebGL早期対応）

**理由：**
1. Sentis統合により技術的ハードルが大幅に低下
2. 早期にWebデモを提供することで、より多くのフィードバックを収集可能
3. 開発工数の増加が最小限（Sentisが大部分を担当）

### 修正されたフェーズ計画

| フェーズ | 期間 | プラットフォーム | 変更点 |
|---------|------|----------------|--------|
| Phase 0 | 1週間 | プロトタイプ | 変更なし |
| Phase 1 | 2週間 | Windows/Linux | 変更なし |
| Phase 2 | 3週間 | Android | 変更なし |
| Phase 3 | 2週間 | **WebGL** | macOSと入れ替え |
| Phase 4 | 2週間 | macOS | WebGLと入れ替え |
| Phase 5 | 2週間 | iOS | 変更なし |
| Phase 6 | 2週間 | 多言語対応 | 変更なし |
| Phase 7 | 1週間 | 品質保証 | 変更なし |

## WebGL実装の技術的詳細

### 必要な作業
1. **音素化ライブラリのWebAssembly化**
   - OpenJTalkのEmscriptenビルド
   - メモリ効率的な辞書管理

2. **Sentis WebGL最適化**
   - WebGPUバックエンドの活用
   - メモリプールの適切な設定

3. **Unity WebGLビルド設定**
   - メモリサイズの最適化
   - 圧縮設定の調整

### 期待されるパフォーマンス
| 処理 | ネイティブ | WebGL（WebGPU） | WebGL（WASM） |
|------|-----------|----------------|--------------|
| 音素化 | 10ms | 30ms | 50ms |
| 音声合成 | 50ms | 100ms | 200ms |
| 合計 | 60ms | 130ms | 250ms |

## リスクと対策

### リスク
1. WebGLのメモリ制限（2GB）
2. 初回ロード時間の増加
3. ブラウザ互換性

### 対策
1. 辞書の段階的ロード
2. PWA対応でキャッシュ活用
3. Chrome/Edge/Firefoxでの動作保証

## 結論

Sentis 2.1.2の採用により、WebGL実装の技術的ハードルが大幅に低下しました。早期にWebGLに対応することで、より多くのユーザーにリーチでき、フィードバックサイクルを高速化できます。

**推奨アクション：**
1. 開発計画書のフェーズ順序を更新
2. WebGL用の音素化ビルドスクリプトの準備
3. Sentis WebGLパフォーマンステストの実施