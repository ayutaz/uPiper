# WebGL対応 残タスク一覧

最終更新: 2025-08-05

## Phase 2完了により、残タスクはPhase 3およびPhase 4のみ

### Phase 3: CI/CDとデプロイ - 残タスク

#### 1. WebGL統合テスト実装
- **目的**: 品質保証
- **内容**:
  - WebGLプラットフォームでのEditModeテスト
  - ブラウザ環境でのPlayModeテスト設定
  - CI/CDパイプラインへの統合
- **見積工数**: 2日

#### 2. ビルドサイズの最適化
- **目的**: ダウンロード時間短縮
- **現状**: 約100MB以上（ONNX + WASM含む）
- **対策**:
  - ONNXモデルの圧縮
  - コードストリッピング設定
  - 不要アセットの除外
- **目標**: 50MB以下
- **見積工数**: 1日

#### 3. WebGLランタイムテスト
- **目的**: 実際のブラウザ環境でのテスト
- **内容**:
  - Chrome/Firefox/Safari/Edgeでの動作確認
  - モバイルブラウザテスト
  - エラーハンドリング確認
- **見積工数**: 2日

#### 4. パフォーマンステスト
- **目的**: 性能基準の確立
- **測定項目**:
  - 初期化時間
  - 音素化レイテンシ
  - 音声生成速度
  - メモリ使用量
- **見積工数**: 2日

### Phase 4: 最適化と拡張 - 全タスク（未着手）

#### 1. メモリ使用量の詳細な最適化
- **目的**: Unity WebGLの1GBヒープ制限への対応
- **内容**:
  - 大規模テキスト処理の改善
  - ガベージコレクション最適化
  - メモリプロファイリング
- **見積工数**: 3日

#### 2. UIの最適化（WebGL向け）
- **目的**: ブラウザ環境でのUX向上
- **内容**:
  - InferenceEngineDemoのUI改善
  - モバイルブラウザ対応
  - レスポンシブデザイン
- **見積工数**: 3日

#### 3. パフォーマンスモニタリング
- **目的**: 実行時の性能可視化
- **内容**:
  - InferenceEngineDemoへの計測機能追加
  - 音素化・音声生成時間の表示
  - メモリ使用量の可視化
- **見積工数**: 2日

#### 4. WASMストリーミングインスタンシエーション
- **目的**: 初回ロード時間短縮
- **内容**:
  - WebAssembly.instantiateStreaming使用
  - プログレス表示実装
- **見積工数**: 2日

#### 5. プログレッシブローディング
- **目的**: UX改善
- **内容**:
  - 段階的な機能有効化
  - ローディング画面改善
  - エラーリカバリー
- **見積工数**: 3日

#### 6. Service Worker対応
- **目的**: オフライン機能
- **内容**:
  - アセットキャッシュ
  - オフライン時の動作
  - 更新通知
- **見積工数**: 4日

#### 7. 高度なeSpeak-ng音素化
- **現状**: 基本的な単語辞書ベース
- **改善点**:
  - 実際のeSpeak-ng IPA出力統合
  - より多くの単語対応
  - 音素変換精度向上
- **見積工数**: 3-4日

#### 8. 中国語音素化エンジン統合
- **目的**: 中国語サポート改善
- **内容**:
  - 中国語専用WebAssemblyエンジン検討
  - ピンイン→音素変換改善
  - トーン処理
- **見積工数**: 1週間

#### 9. SharedArrayBuffer対応
- **目的**: マルチスレッド処理
- **注意**: COOP/COEP必須
- **内容**:
  - Worker間でのメモリ共有
  - 並列処理実装
- **見積工数**: 4日

#### 10. WebGPUバックエンド
- **目的**: GPU処理高速化
- **前提**: Unity AI Inference Engine対応待ち
- **見積工数**: 未定

## 実装順序の推奨

1. **Phase 3完了**（1週間）
   - WebGL統合テスト
   - ビルドサイズ最適化
   - ランタイムテスト
   - パフォーマンステスト

2. **Phase 4基本最適化**（1週間）
   - メモリ使用量最適化
   - UI最適化
   - パフォーマンスモニタリング

3. **Phase 4高度な最適化**（1-2週間）
   - WASMストリーミング
   - プログレッシブローディング
   - Service Worker対応

4. **Phase 4拡張機能**（オプション）
   - 高度なeSpeak-ng音素化
   - 中国語音素化エンジン
   - SharedArrayBuffer対応

## 技術的な課題と注意点

### メモリ管理
- Unity WebGLの1GBヒープ制限
- 大規模テキストでのOOM対策必要
- ガベージコレクション最適化

### ブラウザ互換性
- Safari: WebAssembly SIMD未対応
- iOS Safari: 特殊な制限あり
- モバイル: メモリ制限が厳しい

### セキュリティ
- CORS設定必須
- HTTPS必須（マイク使用時）
- CSP（Content Security Policy）対応

### パフォーマンス
- 初回ロード時間が課題
- 音声生成のリアルタイム性確保
- バックグラウンドタブでの制限

## まとめ

Phase 2の完了により、WebGL対応の基本機能は実装済みです。残りのタスクは：

1. **Phase 3（必須）**: テストとビルド最適化（約1週間）
2. **Phase 4（推奨）**: 最適化と拡張機能（約2-3週間）

総見積工数: 約3-4週間