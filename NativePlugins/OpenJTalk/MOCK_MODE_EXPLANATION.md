# OpenJTalk Mock Mode 説明

## モックモードとは

OpenJTalkPhonemizerには「モックモード」という機能があり、ネイティブライブラリが利用できない場合でも基本的な動作テストができるようになっています。

## モックモードが使用される場合

1. **明示的な指定**
   - `new OpenJTalkPhonemizer(forceMockMode: true)` で強制的にモックモードを使用
   - テストやデバッグ時に便利

2. **ネイティブライブラリが見つからない**
   - 期待されるパスにライブラリファイルが存在しない
   - P/Invokeが無効化されている（WebGLビルドなど）

3. **Unity Test Runner内**
   - テスト実行時は自動的にモックモードになる（ネイティブライブラリのクラッシュを防ぐため）

## モックモードの動作

- 入力テキストの各文字に対して `mock_[文字]` という音素を生成
- 例：「こんにちは」→ `["mock_こ", "mock_ん", "mock_に", "mock_ち", "mock_は"]`
- 実際の音素変換は行われないため、音声合成の品質は期待できない

## モックモードの目的

1. **開発環境の柔軟性**
   - ネイティブライブラリがなくても開発・テストが可能
   - CI/CD環境でのビルドエラーを防ぐ

2. **プラットフォーム互換性**
   - WebGLなど、ネイティブライブラリをサポートしないプラットフォームでの動作

3. **エラー耐性**
   - ライブラリの読み込みに失敗してもアプリケーションがクラッシュしない

## 本番環境での使用

本番環境では必ずネイティブライブラリを使用してください。モックモードでは：
- 正確な日本語音素変換ができない
- カタカナ、漢字の読み仮名変換ができない
- アクセント情報が生成されない

## トラブルシューティング

ネイティブライブラリが見つからない場合は、以下を確認してください：

1. ライブラリファイルの配置場所
   - macOS: `Assets/uPiper/Plugins/macOS/libopenjtalk_wrapper.dylib`
   - Windows: `Assets/uPiper/Plugins/Windows/x86_64/openjtalk_wrapper.dll`
   - Linux: `Assets/uPiper/Plugins/Linux/x86_64/libopenjtalk_wrapper.so`

2. ファイルのインポート設定（.metaファイル）
   - 対象プラットフォームが正しく設定されているか
   - CPU設定が適切か

3. ビルド設定
   - Player SettingsでAllow 'unsafe' Codeが有効か（必要な場合）