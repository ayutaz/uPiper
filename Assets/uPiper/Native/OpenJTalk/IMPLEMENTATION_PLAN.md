# OpenJTalk完全実装計画

## 現状と課題

Phase 1.7で期待されていた「完全なOpenJTalk実装」に対して、現在はスタブ実装のみが完了しています。

### 実装オプション

#### オプション1: フルソースコード統合（推奨しない）
- **メリット**: 完全なコントロール、最適化可能
- **デメリット**: 
  - 実装に2-3週間必要
  - 複雑な依存関係（Mecab、hts_engine_API）
  - メンテナンス負荷が高い
  - ビルドシステムが複雑

#### オプション2: 既存ライブラリのラッピング（推奨）
- **メリット**: 
  - 実装が1週間で可能
  - 実績のあるコードを使用
  - メンテナンスが容易
- **デメリット**: 
  - サイズがやや大きい
  - カスタマイズに制限

#### オプション3: pyopenjtalk方式の軽量実装（最も推奨）
- **メリット**: 
  - 3-5日で実装可能
  - 必要最小限の機能のみ
  - Unity向けに最適化
  - pyopenjtalk-plusと互換性
- **デメリット**: 
  - 一部の高度な機能は省略

## 推奨実装計画（オプション3）

### 実装内容

1. **Mecab軽量版の統合**
   - 必要最小限のMecab機能のみ
   - 静的リンクで組み込み
   - 辞書は圧縮形式で埋め込み

2. **音素変換処理**
   - テキスト → Mecab解析 → 音素列
   - pyopenjtalkと同じ音素体系を使用
   - アクセント情報の保持

3. **Unity向けAPI**
   ```c
   // シンプルなAPI
   int openjtalk_text2phonemes(const char* text, 
                               int* phoneme_ids, 
                               int max_phonemes);
   ```

### 実装手順

1. **Day 1-2: Mecab最小実装**
   - Mecab-lightの実装
   - 辞書の圧縮と埋め込み

2. **Day 3-4: 音素変換実装**
   - OpenJTalkの音素変換ロジック
   - pyopenjtalk互換の出力

3. **Day 5: テストと統合**
   - Unity統合テスト
   - パフォーマンス検証

### 期待される成果

- **精度**: 98%（pyopenjtalkと同等）
- **処理速度**: <10ms/文
- **ライブラリサイズ**: 5-10MB（辞書込み）
- **メモリ使用量**: 20-30MB

## 次のステップ

1. この計画でよろしければ、オプション3の実装を開始します
2. または、オプション2で既存ライブラリを使用する方法も可能です
3. Phase 1.8以降を先に進めて、後でOpenJTalkを差し替えることも可能です

どの方針で進めるべきでしょうか？